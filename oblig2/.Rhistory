geom_smooth(method = "lm", se = FALSE, color = "red") +
theme_bw()
ggsave("plots/oppg4_a.pdf", plot_a, width = 7, height = 4)
# b)
res <- residuals(fit)
plot_resid <- ggplot(d, aes(x = Snoinnhold, y = res)) +
geom_point() +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_bw()
ggsave("plots/oppg4_residualer.pdf", plot_resid, width = 7, height = 4)
plot_qq <- ggplot(data.frame(res), aes(sample = res)) +
stat_qq() + stat_qq_line() +
theme_bw()
ggsave("plots/oppg4_residual_qq.pdf", plot_qq, width = 7, height = 4)
# c)
sigma2_hat <- sum(res^2) / (nrow(d) - 2)
sigma2_hat
confint(fit, "Snoinnhold", level = 0.95)
# d)
beta0 <- coef(fit)[1]
se_b0 <- summary(fit)$coefficients[1,2]
t_b0 <- beta0 / se_b0
p_b0 <- 2 * (1 - pt(abs(t_b0), df = nrow(d) - 2))
c(beta0, se_b0, t_b0, p_b0)
# e)
fit2 <- lm(Vannstand ~ poly(Snoinnhold, 2, raw = TRUE), data = d)
fit3 <- lm(Vannstand ~ poly(Snoinnhold, 3, raw = TRUE), data = d)
AIC(fit, fit2, fit3)
BIC(fit, fit2, fit3)
library(tidyverse)
set.seed(1110)
# Les inn data
d <- read.table("data/snoe_vann.txt", header = FALSE) %>%
as_tibble() %>%
rename(Snoinnhold = V1, Vannstand = V2)
# a) Enkel lineær regresjon
fit <- lm(Vannstand ~ Snoinnhold, data = d)
summary(fit)
plot_a <- d %>%
ggplot(aes(x = Snoinnhold, y = Vannstand)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "red") +
theme_bw()
ggsave("plots/oppg4_a.pdf", plot_a, width = 7, height = 4)
# b) Residualplott og QQ-plot
res <- residuals(fit)
plot_resid <- ggplot(data.frame(Snoinnhold = d$Snoinnhold, res = res),
aes(x = Snoinnhold, y = res)) +
geom_point() +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_bw()
ggsave("plots/oppg4_residualer.pdf", plot_resid, width = 7, height = 4)
plot_qq <- ggplot(data.frame(res), aes(sample = res)) +
stat_qq() +
stat_qq_line() +
theme_bw()
ggsave("plots/oppg4_residual_qq.pdf", plot_qq, width = 7, height = 4)
# c) Estimat av feilvarians og 95% KI for beta_1
sigma2_hat <- sum(res^2) / (nrow(d) - 2)
sigma2_hat
confint(fit, "Snoinnhold", level = 0.95)
# d) Test av H0: beta_0 = 0
beta0 <- coef(fit)[1]
se_b0 <- summary(fit)$coefficients[1, 2]
t_b0 <- beta0 / se_b0
p_b0 <- 2 * (1 - pt(abs(t_b0), df = nrow(d) - 2))
c(beta0 = beta0,
SE_beta0 = se_b0,
t_verdi = t_b0,
p_tosidig = p_b0)
# e) Sammenlign modeller: 1., 2. og 3. grad
fit2 <- lm(Vannstand ~ poly(Snoinnhold, 2, raw = TRUE), data = d)
fit3 <- lm(Vannstand ~ poly(Snoinnhold, 3, raw = TRUE), data = d)
summary(fit2)
summary(fit3)
AIC(fit, fit2, fit3)
BIC(fit, fit2, fit3)
library(tidyverse)
set.seed(1110)
# Les inn data
d <- read.table("data/snoe_vann.txt", header = FALSE) %>%
as_tibble() %>%
rename(Snoinnhold = V1, Vannstand = V2)
# a) Enkel lineær regresjon
fit <- lm(Vannstand ~ Snoinnhold, data = d)
summary(fit)
plot_a <- d %>%
ggplot(aes(x = Snoinnhold, y = Vannstand)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "red") +
theme_bw()
ggsave("plots/oppg4_a.pdf", plot_a, width = 7, height = 4)
# b) Residualplott og QQ-plot
res <- residuals(fit)
plot_resid <- ggplot(data.frame(Snoinnhold = d$Snoinnhold, res = res),
aes(x = Snoinnhold, y = res)) +
geom_point() +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_bw()
ggsave("plots/oppg4_residualer.pdf", plot_resid, width = 7, height = 4)
plot_qq <- ggplot(data.frame(res), aes(sample = res)) +
stat_qq() +
stat_qq_line() +
theme_bw()
ggsave("plots/oppg4_residual_qq.pdf", plot_qq, width = 7, height = 4)
# c) Estimat av feilvarians og 95% KI for beta_1
sigma2_hat <- sum(res^2) / (nrow(d) - 2)
sigma2_hat
confint(fit, "Snoinnhold", level = 0.95)
# d) Test av H0: beta_0 = 0
beta0 <- coef(fit)[1]
se_b0 <- summary(fit)$coefficients[1, 2]
t_b0 <- beta0 / se_b0
p_b0 <- 2 * (1 - pt(abs(t_b0), df = nrow(d) - 2))
c(beta0 = beta0,
SE_beta0 = se_b0,
t_verdi = t_b0,
p_tosidig = p_b0)
# e) Sammenlign modeller: 1., 2. og 3. grad
fit2 <- lm(Vannstand ~ poly(Snoinnhold, 2, raw = TRUE), data = d)
fit3 <- lm(Vannstand ~ poly(Snoinnhold, 3, raw = TRUE), data = d)
summary(fit2)
summary(fit3)
AIC(fit, fit2, fit3)
BIC(fit, fit2, fit3)
library(tidyverse)
set.seed(1110)
# problem 4
d <- read.table("data/snoe_vann.txt", header = FALSE) %>%
as_tibble() %>%
rename(Snoinnhold = V1, Vannstand = V2)
# a)
fit <- lm(Vannstand ~ Snoinnhold, data = d)
summary(fit)
plot_a <- d %>%
ggplot(aes(x = Snoinnhold, y = Vannstand)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "red") +
theme_bw()
ggsave("plots/oppg4_a.pdf", plot_a, width = 7, height = 4)
# b)
res <- residuals(fit)
plot_resid <- ggplot(data.frame(Snoinnhold = d$Snoinnhold, res = res),
aes(x = Snoinnhold, y = res)) +
geom_point() +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_bw()
ggsave("plots/oppg4_residualer.pdf", plot_resid, width = 7, height = 4)
plot_qq <- ggplot(data.frame(res), aes(sample = res)) +
stat_qq() +
stat_qq_line() +
theme_bw()
ggsave("plots/oppg4_residual_qq.pdf", plot_qq, width = 7, height = 4)
# c)
sigma2_hat <- sum(res^2) / (nrow(d) - 2)
sigma2_hat
confint(fit, "Snoinnhold", level = 0.95)
# d)
beta0 <- coef(fit)[1]
se_b0 <- summary(fit)$coefficients[1, 2]
t_b0 <- beta0 / se_b0
p_b0 <- 2 * (1 - pt(abs(t_b0), df = nrow(d) - 2))
c(beta0 = beta0,
SE_beta0 = se_b0,
t_verdi = t_b0,
p_tosidig = p_b0)
# e)
fit2 <- lm(Vannstand ~ poly(Snoinnhold, 2, raw = TRUE), data = d)
fit3 <- lm(Vannstand ~ poly(Snoinnhold, 3, raw = TRUE), data = d)
summary(fit2)
summary(fit3)
AIC(fit, fit2, fit3)
BIC(fit, fit2, fit3)
library(tidyverse)
set.seed(1110)
d <- read.table("data/kveite_for.txt", sep = "", header = TRUE) %>%
as_tibble() %>%
mutate(Fortype = as.factor(Fortype))
# a)
plot_a <- d %>%
ggplot(aes(x = Fortype, y = Vekt, fill = Fortype)) +
geom_boxplot() +
theme_bw()
ggsave("plots/oppg1_a.pdf", plot_a, width = 7, height = 4)
# b)
plot_b <- d %>%
ggplot(aes(sample = Vekt)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ Fortype) +
theme_bw() +
labs(x = "Teoretiske kvantiler", y = "Observerte kvantiler")
ggsave("plots/oppg1_b.pdf", plot_b, width = 7, height = 4)
# c)
A <- d$Vekt[d$Fortype == "A"]
B <- d$Vekt[d$Fortype == "B"]
# d)
sp2 <- ((var(A) * (length(A) - 1) + var(B) * (length(B) - 1)) /
(length(A) + length(B) - 2))
t_obs <- (mean(B) - mean(A)) /
sqrt(sp2 * (1/length(A) + 1/length(B)))
df <- length(A) + length(B) - 2
p_manual <- 1 - pt(t_obs, df)
c(t_verdi = t_obs,
frihetsgrader = df,
p_ensidig = p_manual)
t.test(B, A, var.equal = TRUE, alternative = "greater")
# e)
t.test(B, A, var.equal = FALSE, alternative = "greater")
var.test(B, A)
# f)
f <- d %>% mutate(x = ifelse(Fortype == "B", 1, 0))
fit <- lm(Vekt ~ x, data = f)
summary(fit)
library(tidyverse)
set.seed(1110)
n    <- 31
meanA <- 93.32
sdA   <- 15.41
meanB <- 96.58
sdB   <- 13.84
meanD <- -3.26
sdD   <- 8.81
# a)
# (Parete data: deler samme genetiske materiale → avhengige observasjoner)
# b)
t_obs <- meanD / (sdD / sqrt(n))
df    <- n - 1
pval  <- 2 * (1 - pt(abs(t_obs), df))
c(t_verdi = t_obs,
frihetsgrader = df,
p_tosidig = pval)
# c)
t_crit <- qt(0.975, df)
ci_low  <- meanD - t_crit * sdD / sqrt(n)
ci_high <- meanD + t_crit * sdD / sqrt(n)
c(ci_95_lower = ci_low,
ci_95_upper = ci_high)
c(se_beregnet = sdD / sqrt(n),
se_gitt = 1.58)
library(tidyverse)
set.seed(1110)
n    <- 31
meanA <- 93.32
sdA   <- 15.41
meanB <- 96.58
sdB   <- 13.84
meanD <- -3.26
sdD   <- 8.81
# a)
# (Parete data: deler samme genetiske materiale → avhengige observasjoner)
# b)
t_obs <- meanD / (sdD / sqrt(n))
df    <- n - 1
pval  <- 2 * (1 - pt(abs(t_obs), df))
c(t_verdi = t_obs,
frihetsgrader = df,
p_tosidig = pval)
# c)
t_crit <- qt(0.975, df)
ci_low  <- meanD - t_crit * sdD / sqrt(n)
ci_high <- meanD + t_crit * sdD / sqrt(n)
c(ci_95_lower = ci_low,
ci_95_upper = ci_high)
c(se_beregnet = sdD / sqrt(n),
se_gitt = 1.58)
library(tidyverse)
set.seed(1110)
n_menn    <- 3000
n_kvinner <- 3000
x_menn    <- 486
x_kvinner <- 441
p_menn    <- x_menn / n_menn
p_kvinner <- x_kvinner / n_kvinner
diff_hat  <- p_menn - p_kvinner
# a)
p_pooled <- (x_menn + x_kvinner) / (n_menn + n_kvinner)
se       <- sqrt(p_pooled * (1 - p_pooled) * (1/n_menn + 1/n_kvinner))
z_obs    <- diff_hat / se
pval     <- 2 * (1 - pnorm(abs(z_obs)))
c(z_verdi = z_obs,
p_tosidig = pval)
# b)
prop.test(c(x_menn, x_kvinner),
c(n_menn, n_kvinner),
alternative = "two.sided",
correct = FALSE)
library(tidyverse)
set.seed(1110)
n_menn    <- 3000
n_kvinner <- 3000
x_menn    <- 486
x_kvinner <- 441
p_menn    <- x_menn / n_menn
p_kvinner <- x_kvinner / n_kvinner
diff_hat  <- p_menn - p_kvinner
# a)
p_pooled <- (x_menn + x_kvinner) / (n_menn + n_kvinner)
se       <- sqrt(p_pooled * (1 - p_pooled) * (1/n_menn + 1/n_kvinner))
z_obs    <- diff_hat / se
pval     <- 2 * (1 - pnorm(abs(z_obs)))
c(z_verdi = z_obs,
p_tosidig = pval)
# b)
prop.test(c(x_menn, x_kvinner),
c(n_menn, n_kvinner),
alternative = "two.sided",
correct = FALSE)
library(tidyverse)
set.seed(1110)
n    <- 31
meanA <- 93.32
sdA   <- 15.41
meanB <- 96.58
sdB   <- 13.84
meanD <- -3.26
sdD   <- 8.81
# a)
# b)
t_obs <- meanD / (sdD / sqrt(n))
df    <- n - 1
pval  <- 2 * (1 - pt(abs(t_obs), df))
c(t_verdi = t_obs,
frihetsgrader = df,
p_tosidig = pval)
# c)
t_crit <- qt(0.975, df)
ci_low  <- meanD - t_crit * sdD / sqrt(n)
ci_high <- meanD + t_crit * sdD / sqrt(n)
c(ci_95_lower = ci_low,
ci_95_upper = ci_high)
c(se_beregnet = sdD / sqrt(n),
se_gitt = 1.58)
library(tidyverse)
set.seed(1110)
d <- read.table("data/kveite_for.txt", sep = "", header = TRUE) %>%
as_tibble() %>%
mutate(Fortype = as.factor(Fortype))
# a)
plot_a <- d %>%
ggplot(aes(x = Fortype, y = Vekt, fill = Fortype)) +
geom_boxplot() +
theme_bw()
ggsave("plots/oppg1_a.pdf", plot_a, width = 7, height = 4)
# b)
plot_b <- d %>%
ggplot(aes(sample = Vekt)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ Fortype) +
theme_bw() +
labs(x = "Teoretiske kvantiler", y = "Observerte kvantiler")
ggsave("plots/oppg1_b.pdf", plot_b, width = 7, height = 4)
# c)
A <- d$Vekt[d$Fortype == "A"]
B <- d$Vekt[d$Fortype == "B"]
# d)
sp2 <- ((var(A) * (length(A) - 1) + var(B) * (length(B) - 1)) /
(length(A) + length(B) - 2))
t_obs <- (mean(B) - mean(A)) /
sqrt(sp2 * (1/length(A) + 1/length(B)))
df <- length(A) + length(B) - 2
p_manual <- 1 - pt(t_obs, df)
c(t_verdi = t_obs,
frihetsgrader = df,
p_ensidig = p_manual)
t.test(B, A, var.equal = TRUE, alternative = "greater")
# e)
t.test(B, A, var.equal = FALSE, alternative = "greater")
var.test(B, A)
# f)
f <- d %>% mutate(x = ifelse(Fortype == "B", 1, 0))
fit <- lm(Vekt ~ x, data = f)
summary(fit)
t_obs <- (mean(B) - mean(A)) /
sqrt(sp2 * (1/length(A) + 1/length(B)))
library(tidyverse)
set.seed(1110)
d <- read.table("data/kveite_for.txt", sep = "", header = TRUE) %>%
as_tibble() %>%
mutate(Fortype = as.factor(Fortype))
# a)
plot_a <- d %>%
ggplot(aes(x = Fortype, y = Vekt, fill = Fortype)) +
geom_boxplot() +
theme_bw()
ggsave("plots/oppg1_a.pdf", plot_a, width = 7, height = 4)
# b)
plot_b <- d %>%
ggplot(aes(sample = Vekt)) +
stat_qq() +
stat_qq_line() +
facet_wrap(~ Fortype) +
theme_bw() +
labs(x = "Teoretiske kvantiler", y = "Observerte kvantiler")
ggsave("plots/oppg1_b.pdf", plot_b, width = 7, height = 4)
# c)
A <- d$Vekt[d$Fortype == "A"]
B <- d$Vekt[d$Fortype == "B"]
# d)
sp2 <- ((var(A) * (length(A) - 1) + var(B) * (length(B) - 1)) /
(length(A) + length(B) - 2))
t_obs <- (mean(B) - mean(A)) /
sqrt(sp2 * (1/length(A) + 1/length(B)))
df <- length(A) + length(B) - 2
p_manual <- 1 - pt(t_obs, df)
c(t_verdi = t_obs,
frihetsgrader = df,
p_ensidig = p_manual)
t.test(B, A, var.equal = TRUE, alternative = "greater")
# e)
t.test(B, A, var.equal = FALSE, alternative = "greater")
var.test(B, A)
# f)
f <- d %>% mutate(x = ifelse(Fortype == "B", 1, 0))
fit <- lm(Vekt ~ x, data = f)
summary(fit)
library(tidyverse)
set.seed(1110)
n    <- 31
meanA <- 93.32
sdA   <- 15.41
meanB <- 96.58
sdB   <- 13.84
meanD <- -3.26
sdD   <- 8.81
# a)
# b)
t_obs <- meanD / (sdD / sqrt(n))
df    <- n - 1
pval  <- 2 * (1 - pt(abs(t_obs), df))
c(t_verdi = t_obs,
frihetsgrader = df,
p_tosidig = pval)
# c)
t_crit <- qt(0.975, df)
ci_low  <- meanD - t_crit * sdD / sqrt(n)
ci_high <- meanD + t_crit * sdD / sqrt(n)
c(ci_95_lower = ci_low,
ci_95_upper = ci_high)
c(se_beregnet = sdD / sqrt(n),
se_gitt = 1.58)
library(tidyverse)
set.seed(1110)
n_menn    <- 3000
n_kvinner <- 3000
x_menn    <- 486
x_kvinner <- 441
p_menn    <- x_menn / n_menn
p_kvinner <- x_kvinner / n_kvinner
diff_hat  <- p_menn - p_kvinner
# a)
p_pooled <- (x_menn + x_kvinner) / (n_menn + n_kvinner)
se       <- sqrt(p_pooled * (1 - p_pooled) * (1/n_menn + 1/n_kvinner))
z_obs    <- diff_hat / se
pval     <- 2 * (1 - pnorm(abs(z_obs)))
c(z_verdi = z_obs,
p_tosidig = pval)
# b)
prop.test(c(x_menn, x_kvinner),
c(n_menn, n_kvinner),
alternative = "two.sided",
correct = FALSE)
library(tidyverse)
set.seed(1110)
# problem 4
d <- read.table("data/snoe_vann.txt", header = FALSE) %>%
as_tibble() %>%
rename(Snoinnhold = V1, Vannstand = V2)
# a)
fit <- lm(Vannstand ~ Snoinnhold, data = d)
summary(fit)
plot_a <- d %>%
ggplot(aes(x = Snoinnhold, y = Vannstand)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "red") +
theme_bw()
ggsave("plots/oppg4_a.pdf", plot_a, width = 7, height = 4)
# b)
res <- residuals(fit)
plot_resid <- ggplot(data.frame(Snoinnhold = d$Snoinnhold, res = res),
aes(x = Snoinnhold, y = res)) +
geom_point() +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_bw()
ggsave("plots/oppg4_residualer.pdf", plot_resid, width = 7, height = 4)
plot_qq <- ggplot(data.frame(res), aes(sample = res)) +
stat_qq() +
stat_qq_line() +
theme_bw()
ggsave("plots/oppg4_residual_qq.pdf", plot_qq, width = 7, height = 4)
# c)
sigma2_hat <- sum(res^2) / (nrow(d) - 2)
sigma2_hat
confint(fit, "Snoinnhold", level = 0.95)
# d)
beta0 <- coef(fit)[1]
se_b0 <- summary(fit)$coefficients[1, 2]
t_b0 <- beta0 / se_b0
p_b0 <- 2 * (1 - pt(abs(t_b0), df = nrow(d) - 2))
c(beta0 = beta0,
SE_beta0 = se_b0,
t_verdi = t_b0,
p_tosidig = p_b0)
# e)
fit2 <- lm(Vannstand ~ poly(Snoinnhold, 2, raw = TRUE), data = d)
fit3 <- lm(Vannstand ~ poly(Snoinnhold, 3, raw = TRUE), data = d)
summary(fit2)
summary(fit3)
AIC(fit, fit2, fit3)
BIC(fit, fit2, fit3)
c(beta0 = beta0, SE_beta0 = se_b0, t_verdi = t_b0, p_tosidig = p_b0)
